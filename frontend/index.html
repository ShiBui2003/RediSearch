<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RediSearch — Reddit Search Engine</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div id="app">

        <!-- STICKY NAVBAR -->
        <nav class="navbar">
            <div class="nav-brand" onclick="showPage('search')">
                <div class="nav-logo-mark">
                    <svg viewBox="0 0 32 32" width="28" height="28">
                        <defs>
                            <linearGradient id="brandGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#FF5722"/>
                                <stop offset="100%" stop-color="#FF4500"/>
                            </linearGradient>
                        </defs>
                        <circle cx="16" cy="16" r="15" fill="url(#brandGrad)"/>
                        <ellipse cx="16" cy="19" rx="9" ry="7" fill="#fff"/>
                        <circle cx="12.5" cy="17.5" r="2.3" fill="#FF4500"/>
                        <circle cx="19.5" cy="17.5" r="2.3" fill="#FF4500"/>
                        <circle cx="12.5" cy="17" r="0.9" fill="#fff"/>
                        <circle cx="19.5" cy="17" r="0.9" fill="#fff"/>
                        <line x1="16" y1="5" x2="22" y2="2" stroke="#FF4500" stroke-width="1.5" stroke-linecap="round"/>
                        <circle cx="22.5" cy="1.8" r="1.8" fill="none" stroke="#FF4500" stroke-width="1.2"/>
                    </svg>
                </div>
                <span class="logo-text">Redi<span class="logo-accent">Search</span></span>
            </div>

            <div class="nav-center">
                <a href="#" class="nav-link active" data-page="search" onclick="showPage('search')">
                    <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.8" width="16" height="16">
                        <circle cx="9" cy="9" r="6.5"></circle><path d="m14 14 4 4"></path>
                    </svg>
                    Search
                </a>
                <a href="#" class="nav-link" data-page="crawl" onclick="showPage('crawl')">
                    <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.8" width="16" height="16">
                        <path d="M10 2 2 6l8 4 8-4-8-4z"></path><path d="M2 14l8 4 8-4"></path><path d="M2 10l8 4 8-4"></path>
                    </svg>
                    Crawl
                </a>
                <a href="#" class="nav-link" data-page="stats" onclick="showPage('stats')">
                    <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1.8" width="16" height="16">
                        <rect x="2" y="10" width="4" height="8" rx="1"></rect><rect x="8" y="6" width="4" height="12" rx="1"></rect><rect x="14" y="2" width="4" height="16" rx="1"></rect>
                    </svg>
                    Dashboard
                </a>
            </div>

            <div class="nav-right">
                <div class="health-indicator" id="health-indicator" title="System status">
                    <span class="health-dot"></span>
                    <span class="health-label">Checking...</span>
                </div>
            </div>
        </nav>

        <!-- SEARCH PAGE -->
        <div id="page-search" class="page active">
            <div class="bg-shapes">
                <div class="bg-blob blob-1"></div>
                <div class="bg-blob blob-2"></div>
                <div class="bg-blob blob-3"></div>
            </div>

            <div class="search-hero" id="search-hero">
                <!-- Mascot with telescope -->
                <div class="mascot-container" id="mascot-container">
                    <svg class="mascot" viewBox="0 0 140 160" xmlns="http://www.w3.org/2000/svg">
                        <g class="mascot-antenna-group">
                            <line class="mascot-antenna" x1="70" y1="28" x2="90" y2="6" stroke="#FF4500" stroke-width="2.5" stroke-linecap="round"/>
                            <circle class="mascot-antenna-ball" cx="92" cy="4" r="4.5" fill="#FF4500" opacity="0.9"/>
                            <circle class="mascot-antenna-glow" cx="92" cy="4" r="7" fill="none" stroke="#FF4500" stroke-width="1" opacity="0.3"/>
                        </g>
                        <circle cx="38" cy="42" r="7" fill="#FF4500"/>
                        <circle cx="102" cy="42" r="7" fill="#FF4500"/>
                        <ellipse cx="70" cy="52" rx="34" ry="28" fill="#FF4500"/>
                        <ellipse cx="70" cy="56" rx="26" ry="19" fill="#fff"/>
                        <g class="mascot-eyes">
                            <circle cx="58" cy="52" r="5" fill="#FF4500"/>
                            <circle cx="82" cy="52" r="5" fill="#FF4500"/>
                            <circle class="mascot-pupil-l" cx="59.5" cy="51" r="2" fill="#fff"/>
                            <circle class="mascot-pupil-r" cx="83.5" cy="51" r="2" fill="#fff"/>
                        </g>
                        <path d="M60 64 Q70 71 80 64" fill="none" stroke="#FF4500" stroke-width="1.8" stroke-linecap="round"/>
                        <rect x="48" y="82" width="44" height="32" rx="14" fill="#FF4500"/>
                        <g class="mascot-telescope-group">
                            <path class="mascot-arm-r" d="M92 92 Q108 86 118 78" stroke="#FF4500" stroke-width="5.5" fill="none" stroke-linecap="round"/>
                            <rect x="114" y="68" width="22" height="8" rx="3" fill="#5B4FD4" transform="rotate(-30 125 72)"/>
                            <rect x="110" y="70" width="6" height="6" rx="2" fill="#7B6FF0" transform="rotate(-30 113 73)"/>
                            <circle cx="133" cy="63" r="4" fill="none" stroke="#5B4FD4" stroke-width="1.5" opacity="0.7"/>
                        </g>
                        <path class="mascot-arm-l" d="M48 92 Q32 88 24 100" stroke="#FF4500" stroke-width="5.5" fill="none" stroke-linecap="round"/>
                        <path d="M58 114 L54 134" stroke="#FF4500" stroke-width="5.5" fill="none" stroke-linecap="round"/>
                        <path d="M82 114 L86 134" stroke="#FF4500" stroke-width="5.5" fill="none" stroke-linecap="round"/>
                        <ellipse cx="52" cy="137" rx="8" ry="3.5" fill="#FF4500"/>
                        <ellipse cx="88" cy="137" rx="8" ry="3.5" fill="#FF4500"/>
                    </svg>
                </div>

                <h1 class="hero-title">
                    <span class="title-word">Search</span>
                    <span class="title-word title-accent">Reddit</span>
                    <span class="title-word">like never before</span>
                </h1>
                <p class="hero-subtitle">BM25-powered full-text search with real-time crawling &amp; indexing</p>

                <div class="search-container">
                    <div class="search-box" id="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input
                            type="text"
                            id="search-input"
                            class="search-input"
                            placeholder="Search r/python for decorators..."
                            autocomplete="off"
                            spellcheck="false"
                        >
                        <div class="search-filters">
                            <select id="subreddit-filter" class="subreddit-select">
                                <option value="">All subreddits</option>
                            </select>
                        </div>
                        <button class="search-submit" id="search-submit" onclick="doSearch()" title="Search">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2" width="18" height="18">
                                <path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path>
                            </svg>
                        </button>
                        <div class="autocomplete-dropdown" id="autocomplete-dropdown"></div>
                    </div>
                    <div class="search-hints">
                        <span class="hint-key">Enter</span> to search
                        <span class="hint-sep">&middot;</span>
                        <span class="hint-key">&uarr;&darr;</span> navigate suggestions
                    </div>
                </div>
            </div>

            <div class="results-area" id="results-area">
                <div class="results-header" id="results-header"></div>
                <div class="results-list" id="results-list"></div>
                <div class="results-pagination" id="results-pagination"></div>
            </div>
        </div>

        <!-- CRAWL PAGE -->
        <div id="page-crawl" class="page">
            <div class="crawl-container">
                <div class="crawl-card glass-card">
                    <div class="card-header">
                        <div class="card-icon-wrap">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                                <path d="M2 17l10 5 10-5"></path>
                                <path d="M2 12l10 5 10-5"></path>
                            </svg>
                        </div>
                        <div>
                            <h2 class="card-title">Crawl Pipeline</h2>
                            <p class="card-desc">Fetch, preprocess, and index posts from any subreddit</p>
                        </div>
                    </div>

                    <div class="crawl-form">
                        <div class="input-group">
                            <label for="crawl-subreddit">Subreddit</label>
                            <div class="prefixed-input">
                                <span class="input-prefix">r/</span>
                                <input type="text" id="crawl-subreddit" placeholder="python" class="crawl-input">
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="crawl-pages">Pages</label>
                            <input type="number" id="crawl-pages" value="2" min="1" max="20" class="crawl-input small">
                        </div>
                        <button class="btn-primary" id="crawl-btn" onclick="startCrawl()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="btn-icon" width="18" height="18">
                                <path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path>
                            </svg>
                            Start Pipeline
                        </button>
                    </div>

                    <div class="pipeline-progress" id="pipeline-progress" style="display:none;">
                        <h3 class="progress-title">Pipeline Progress</h3>
                        <div class="progress-stages">
                            <div class="stage" id="stage-crawl">
                                <div class="stage-dot"></div>
                                <div class="stage-info">
                                    <span class="stage-name">Crawl</span>
                                    <span class="stage-detail" id="stage-crawl-detail">Waiting...</span>
                                </div>
                            </div>
                            <div class="stage" id="stage-preprocess">
                                <div class="stage-dot"></div>
                                <div class="stage-info">
                                    <span class="stage-name">Preprocess</span>
                                    <span class="stage-detail" id="stage-preprocess-detail">Waiting...</span>
                                </div>
                            </div>
                            <div class="stage" id="stage-index">
                                <div class="stage-dot"></div>
                                <div class="stage-info">
                                    <span class="stage-name">Build Index</span>
                                    <span class="stage-detail" id="stage-index-detail">Waiting...</span>
                                </div>
                            </div>
                            <div class="stage" id="stage-autocomplete">
                                <div class="stage-dot"></div>
                                <div class="stage-info">
                                    <span class="stage-name">Autocomplete</span>
                                    <span class="stage-detail" id="stage-autocomplete-detail">Waiting...</span>
                                </div>
                            </div>
                        </div>
                        <div class="progress-result" id="pipeline-result"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- DASHBOARD PAGE -->
        <div id="page-stats" class="page">
            <div class="stats-container">
                <div class="stats-header">
                    <h2 class="page-title">System Dashboard</h2>
                    <p class="page-subtitle">Real-time engine metrics</p>
                </div>
                <div class="stats-grid" id="stats-grid">
                    <div class="stat-card glass-card">
                        <div class="stat-icon stat-icon-posts">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                <polyline points="14 2 14 8 20 8"></polyline>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-posts" data-target="0">0</div>
                        <div class="stat-label">Raw Posts</div>
                    </div>
                    <div class="stat-card glass-card">
                        <div class="stat-icon stat-icon-processed">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                                <polyline points="9 11 12 14 22 4"></polyline>
                                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-processed" data-target="0">0</div>
                        <div class="stat-label">Processed</div>
                    </div>
                    <div class="stat-card glass-card">
                        <div class="stat-icon stat-icon-indexes">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                                <rect x="2" y="3" width="20" height="6" rx="2"></rect>
                                <rect x="2" y="15" width="20" height="6" rx="2"></rect>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-indexes" data-target="0">0</div>
                        <div class="stat-label">Active Indexes</div>
                    </div>
                    <div class="stat-card glass-card">
                        <div class="stat-icon stat-icon-subs">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="22" height="22">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="2" y1="12" x2="22" y2="12"></line>
                                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                            </svg>
                        </div>
                        <div class="stat-value" id="stat-subreddits" data-target="0">0</div>
                        <div class="stat-label">Subreddits</div>
                    </div>
                </div>
                <div class="subreddit-list-section glass-card">
                    <h3>Indexed Subreddits</h3>
                    <div class="subreddit-chips" id="subreddit-chips"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
